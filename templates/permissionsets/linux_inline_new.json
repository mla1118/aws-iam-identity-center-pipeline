{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "GenericLinuxAccess",
            "Action": [
                "ec2:RebootInstances",
                "ec2:RunInstances",
                "ec2:StartInstances",
                "ec2:StopInstances",
                "ec2:RebootInstances",
                "ec2:*Snapshot*",
                "ec2:*Image*"
            ],
            "Effect": "Allow",
            "Resource": "*"
        },
        {
            "Sid": "SessionAccessStart",
            "Effect": "Allow",
            "Action": [
                "ssm:StartSession",
                "ssm:SendCommand"
            ],
            "Resource": "*"
        },
        {
            "Sid": "SessionAccess",
            "Action": [
                "ssm:TerminateSession",
                "ssm:ResumeSession"
            ],
            "Effect": "Deny",
            "NotResource": [
                "arn:aws:ssm:*:*:session/${aws:username}-*"
            ]
        },
        {
            "Sid": "SSMAccess",
            "Action": [
                "ssm:PutParameter"
            ],
            "Effect": "Allow",
            "Resource": [
                "arn:aws:ssm:*:*:parameter/OSTeam/*",
                "arn:aws:ssm:*:*:parameter/Ami_*",
                "arn:aws:ssm:*:*:parameter/*AMI*"
            ]
        },
        {
            "Sid": "S3Access",
            "Effect": "Allow",
            "Action": [
                "s3:PutObject",
                "s3:DeleteObject"
            ],
            "Resource": [
                "arn:aws:s3:::linux-ops*"
            ]
        },
        {
            "Sid": "KMSAccessEBS",
            "Effect": "Allow",
            "Action": [
                "kms:DescribeKey",
                "kms:RetireGrant",
                "kms:CreateGrant",
                "kms:ReEncrypt*",
                "kms:GenerateDataKey*",
                "kms:Encrypt",
                "kms:Decrypt"
            ],
            "Resource": "*",
            "Condition": {
                "ForAnyValue:StringLike": {
                    "kms:ResourceAliases": [
                        "alias/aws/ebs"
                    ]
                }
            }
        },
        {
            "Sid": "KMSAccessEBSAMICopy",
            "Effect": "Allow",
            "Action": [
                "kms:DescribeKey",
                "kms:RetireGrant",
                "kms:CreateGrant",
                "kms:ReEncrypt*",
                "kms:GenerateDataKey*",
                "kms:Encrypt",
                "kms:Decrypt"
            ],
            "Resource": [
                "arn:aws:kms:us-west-2:271562797580:key/mrk-36dc33fa58374c50b9ffba79c99302d8",
                "arn:aws:kms:us-west-2:271562797580:key/0631c62f-09ec-407e-b173-ebb449f75b50",
                "arn:aws:kms:us-east-1:271562797580:key/ec85097d-f10a-4869-9e39-4ae87e7e1ba7"
            ]
        }
    ]
}